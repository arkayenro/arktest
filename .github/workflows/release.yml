name: Packager-Stable

on:
  push:
    tags:
      - '[0-9][0-9]?.[0-9][0-9].[0-9][0-9]'
      - '[0-9][0-9]?.[0-9][0-9].[0-9][0-9]-alpha-[0-9]+'

jobs:
  
  dump:
    runs-on: ubuntu-latest
    steps:
    - name: Dump
      run: |
        echo ${{ github.event }}
        echo ${{ github.event_name }}
        echo ${{ github.event_path }}
        echo ${{ github.ref }}
        echo ${{ github.prerelease }}
          
  release:
    if: ${{ !contains(github.ref,'alpha') }}
    runs-on: ubuntu-latest
    env:
      CF_API_KEY: ${{ secrets.CF_API_KEY }}
      WOWI_API_TOKEN: ${{ secrets.WOWI_API_TOKEN }}
      WAGO_API_TOKEN: ${{ secrets.WAGO_API_TOKEN }}
      GITHUB_OAUTH: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - name: Clone project
        uses: actions/checkout@v1
      - name: Package (release)
        uses: BigWigsMods/packager@v1.0.3
        with:
          args: -g mainline,bcc,clasic -n "{package-name}-{project-version}{nolib}:{project-version}{nolib}"
# 

  alpha:
    if: ${{ contains(github.ref,'alpha') }}
    runs-on: ubuntu-latest
    env:
      CF_API_KEY: ${{ secrets.CF_API_KEY }}
      WOWI_API_TOKEN: ${{ secrets.WOWI_API_TOKEN }}
      WAGO_API_TOKEN: ${{ secrets.WAGO_API_TOKEN }}
      GITHUB_OAUTH: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - name: Clone project
        uses: actions/checkout@v1
      - name: Package (alpha)
        uses: BigWigsMods/packager@v1.0.3
        with:
          args: -w 0 -n "{package-name}-{project-version}:{project-version}"
          
# -w 0 = not wowinterface, it doesnt support alpha/beta, only release
        
        
#      - name: Package nolib
#        uses: BigWigsMods/packager@v1
#        with:
#          args: -s # nolib
